<?phpfunction GetSimplify(&$nm) {    $nm = str_replace(";", "", $nm);}$dbh = mysql_connect(SERVER, PREFIX . USER, PASS);if (!$dbh) {    echo "connection to database failed.";}$db = mysql_select_db(PREFIX . DATABASE);if (!$db) {    echo "Database selection failed.";}//$q =  htmlentities($_REQUEST['q']);$q = $_REQUEST['q'];$q = strtolower($q);//$q = str_replace("'","" ,$q);$q = rtrim($q);$action = substr($q, 0, strpos($q, " ") + 1);$action = rtrim($action);$action = trim($action);switch ($action) {    case 'drop':        $tbl = substr($q, strpos($q, "table ") + 6);        if (strpos($tbl, " ") > 0) {            $tbl = substr($tbl, 0, strpos($tbl, " ") + 1);        }        GetSimplify($tbl);        $query = mysql_query($q);        if (!$query) {            echo "Query <em class='code'>" . $q . "</em> execution failed.";        } else {            echo "<span class='success'>Table '$tbl' deleted successfully.</span>";        }        break;    case 'delete':        $tbl = substr($q, strpos($q, "table ") + 6);        if (strpos($tbl, " ") > 0) {            $tbl = substr($tbl, 0, strpos($tbl, " ") + 1);        }        $query = mysql_query($q);        if (!$query) {            echo "Query <em class='code'>" . $q . "</em> execution failed.";        } else {            echo "<span class='success'>$tbl values deleted successfully.</span>";        }        break;    case 'update':        $tbl = substr($q, strpos($q, "table ") + 6);        if (strpos($tbl, " ") > 0) {            $tbl = substr($tbl, 0, strpos($tbl, " ") + 1);        }        $query = mysql_query($q);        if (!$query) {            echo "Query <em class='code'>" . $q . "</em> execution failed.";        } else {            echo "<span class='success'>$tbl updated successfully.</span>";        }        break;        break;    case "select":        $tbl = substr($q, strpos($q, "from ") + 5);        if (strpos($tbl, " ") > 0) {            $tbl = substr($tbl, 0, strpos($tbl, " ") + 1);        }        $tbl = rtrim($tbl);        $tbl = trim($tbl);        $rquery = mysql_query($q);        if ($rquery) {            if (strpos($q, "*") > 0) {                $c = "SELECT `COLUMN_NAME` FROM `INFORMATION_SCHEMA`.`COLUMNS`  WHERE `TABLE_SCHEMA` = '" . PREFIX . DATABASE . "' AND `TABLE_NAME` = '$tbl'";                $query = mysql_query($c, $dbh);                if ($query == FALSE) {                    $ccount = 0;                } else {                    $ccount = mysql_num_rows($query);                }            } else {                $columns = substr($q, strpos($q, "select ") + 7, strpos($q, "from ") - (strpos($q, "select ") + 7));                $arr = explode(",", $columns);                $ccount = count($arr);            }            if ($ccount > 0) {                echo "<table class='resulttable' width='100%'>";                if (!isset($columns)) {                    $arr = array();                    while ($row = mysql_fetch_array($query)) {                        $arr[] = $row['COLUMN_NAME'];                    }                }                echo "<tr style='width:100%;'>";                $wdth = 1024 / count($arr);                foreach ($arr as $th => $v) {                    echo ("<th style='width:{$wdth}px;'>{$v}</th>");                }                echo "</tr>";                $cres = mysql_num_rows($rquery);                if ($cres > 0) {                    while ($qresult = mysql_fetch_row($rquery)) {                        echo "<tr>";                        foreach ($qresult as $td) {                            echo "<td>{$td}</td>";                        }                        $qresult = null;                        echo "</tr>";                    }                } else {                    echo "<tr><td colspan='" . $ccount . "' align='center'>No records to display.</td></tr>";                }                echo "</table>";            } else {                echo "No result found for query <em class='code'>" . $q . "</em> in table $tbl";            }        } else {            echo "<span class='error'>" . mysql_error() . "</span>";        }        break;    default:        $ac = substr($q, 0, strpos($q, " ") + 1);        $ac = rtrim($ac);        $ac = trim($ac);        switch ($ac) {            case 'desc':                $query = mysql_query($q);                if (!$query) {                    echo "Query <em class='code'>" . $q . "</em> execution failed.";                } else {                    echo "<table class='resulttable'>";                    echo "<tr>";                    echo "<th>Field</td><th>Type</th><th>Null</th><th>Key</th><th>Default</th><th>Extra</th>";                    echo "</tr>";                    while ($res = mysql_fetch_row($query)) {                        echo "<tr>";                        for ($i = 0; $i < (count($res)); $i++) {                            echo ("<td>" . $res[$i] . "</td>");                        }                        echo "</tr>";                    }                    echo "</table>";                }                break;            default:                if (strlen($q) > 1) {                    $query = mysql_query($q);                    if (!$query) {                        echo "Query <em class='code'>" . $q . "</em> execution failed.";                    } else {                        echo "<span class='success'>Query executed successfully</span>";                    }                }                break;        }        break;}unset($_REQUEST);?>